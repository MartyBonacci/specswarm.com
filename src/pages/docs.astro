---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Button from '../components/Button.astro';
import CodeBlock from '../components/CodeBlock.astro';

const commandCategories = [
  {
    title: 'High-Level Commands (v3.0)',
    description: 'Simplified workflow - build features in 2 commands',
    commands: [
      {
        name: '/specswarm:build',
        description: 'Complete feature development from spec to implementation. Handles planning, task breakdown, execution, and quality analysis autonomously.',
        usage: '/specswarm:build "feature description" [--validate] [--quality-gate N]',
        flags: [
          { flag: '--validate', description: 'Run Playwright browser testing during implementation' },
          { flag: '--quality-gate N', description: 'Set minimum quality score (default: 80)' },
        ],
      },
      {
        name: '/specswarm:fix',
        description: 'Test-driven bug fixing with automatic retry logic. Creates regression tests first, then implements and validates fix.',
        usage: '/specswarm:fix "bug description" [--regression-test] [--hotfix] [--max-retries N]',
        flags: [
          { flag: '--regression-test', description: 'Create failing test before fixing (TDD approach)' },
          { flag: '--hotfix', description: 'Expedited workflow for production emergencies' },
          { flag: '--max-retries N', description: 'Maximum fix attempts (default: 2)' },
        ],
      },
      {
        name: '/specswarm:upgrade',
        description: 'Framework and dependency migrations with breaking change analysis. Automated refactoring with codemods and guided manual tasks.',
        usage: '/specswarm:upgrade "migration description" [--dry-run]',
        flags: [
          { flag: '--dry-run', description: 'Analyze risks without making changes' },
        ],
      },
      {
        name: '/specswarm:ship',
        description: 'Quality-gated merge to parent branch. Analyzes quality, enforces thresholds, and provides remediation steps if needed.',
        usage: '/specswarm:ship [--force-quality N]',
        flags: [
          { flag: '--force-quality N', description: 'Override quality threshold for this merge' },
        ],
      },
    ],
  },
  {
    title: 'Granular Workflow (Manual Control)',
    description: 'Step-by-step control for complex features',
    commands: [
      {
        name: '/specswarm:specify',
        description: 'Create detailed feature specification. Generates spec.md with user scenarios, functional requirements, and success criteria.',
        usage: '/specswarm:specify "feature description"',
      },
      {
        name: '/specswarm:clarify',
        description: 'Ask up to 5 targeted clarification questions. Encodes answers back into specification to eliminate ambiguity.',
        usage: '/specswarm:clarify',
      },
      {
        name: '/specswarm:plan',
        description: 'Design implementation with tech stack validation. Creates plan.md with phases, design decisions, and tech compliance report.',
        usage: '/specswarm:plan',
      },
      {
        name: '/specswarm:tasks',
        description: 'Generate dependency-ordered task breakdown. Creates tasks.md with acceptance criteria and parallelization flags.',
        usage: '/specswarm:tasks',
      },
      {
        name: '/specswarm:implement',
        description: 'Execute implementation plan. Processes tasks sequentially with checkpoint updates and error handling.',
        usage: '/specswarm:implement',
      },
      {
        name: '/specswarm:complete',
        description: 'Finish feature and merge to parent branch. Shows merge plan before executing, validates branch safety.',
        usage: '/specswarm:complete',
      },
    ],
  },
  {
    title: 'Quality & Analysis',
    description: 'Validate quality and assess impact',
    commands: [
      {
        name: '/specswarm:analyze-quality',
        description: 'Comprehensive 0-100 quality scoring. Analyzes test coverage, bundle size, code quality, and more.',
        usage: '/specswarm:analyze-quality',
      },
      {
        name: '/specswarm:impact',
        description: 'Standalone impact analysis for features or changes. Assesses affected files, risks, and required tests.',
        usage: '/specswarm:impact "change description"',
      },
      {
        name: '/specswarm:suggest',
        description: 'AI-powered workflow recommendations based on context analysis. Suggests simplified vs. granular approach.',
        usage: '/specswarm:suggest "task description"',
      },
    ],
  },
  {
    title: 'Bug & Issue Management',
    description: 'Fix bugs with regression testing',
    commands: [
      {
        name: '/specswarm:bugfix',
        description: 'Regression-test-first bug fixing. Creates failing test, implements fix, validates across scenarios.',
        usage: '/specswarm:bugfix "bug description with reproduction steps"',
      },
      {
        name: '/specswarm:hotfix',
        description: 'Emergency production fix workflow. Expedited process with critical priority and immediate validation.',
        usage: '/specswarm:hotfix "production issue description"',
      },
    ],
  },
  {
    title: 'Code Maintenance',
    description: 'Modify, refactor, and deprecate features',
    commands: [
      {
        name: '/specswarm:modify',
        description: 'Feature modification workflow with impact analysis. Assesses backward compatibility before changes.',
        usage: '/specswarm:modify "modification description"',
      },
      {
        name: '/specswarm:refactor',
        description: 'Metrics-driven code quality improvement. Maintains behavior while improving structure and performance.',
        usage: '/specswarm:refactor "refactoring goals"',
      },
      {
        name: '/specswarm:deprecate',
        description: 'Phased feature sunset workflow. Provides migration guidance and removes deprecated code safely.',
        usage: '/specswarm:deprecate "feature to remove"',
      },
    ],
  },
  {
    title: 'Project Setup',
    description: 'Initialize and configure projects',
    commands: [
      {
        name: '/specswarm:init',
        description: 'Initialize project with constitution, tech stack, and quality standards. Auto-detects from package.json.',
        usage: '/specswarm:init [--minimal]',
        flags: [
          { flag: '--minimal', description: 'Use minimal defaults without interactive questions' },
        ],
      },
      {
        name: '/specswarm:constitution',
        description: 'Create or update project constitution. Establishes coding principles and governance rules.',
        usage: '/specswarm:constitution',
      },
      {
        name: '/specswarm:checklist',
        description: 'Generate custom requirement checklists based on feature specifications.',
        usage: '/specswarm:checklist',
      },
    ],
  },
];

const quickStart = `/plugin https://github.com/MartyBonacci/specswarm
/plugin install specswarm
/specswarm:init
/specswarm:build "your first feature" --validate
/specswarm:ship`;
---

<BaseLayout
  title="Documentation - SpecSwarm"
  description="Complete command reference for SpecSwarm. 28 commands organized by category with usage examples, flags, and best practices for spec-driven development."
>
  <Header />

  <main>
    <!-- Hero Section -->
    <section class="bg-[var(--color-background)] border-b border-[var(--color-border)] py-[var(--spacing-section-md)]">
      <div class="content-max">
        <div class="max-w-[48rem] mx-auto text-center">
          <h1 class="text-[var(--font-size-display-l)] font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-md)] md:text-[var(--font-size-display-m)]">Documentation</h1>
          <p class="text-[var(--font-size-paragraph-l)] text-[var(--color-secondary)] leading-relaxed m-0">
            Complete command reference with usage examples and best practices
          </p>
        </div>
      </div>
    </section>

    <!-- Quick Start -->
    <section class="bg-[var(--color-surface)] py-[var(--spacing-section-md)]">
      <div class="content-max">
        <div class="max-w-[48rem] mx-auto">
          <h2 class="text-[var(--font-size-display-m)] font-bold text-[var(--color-primary)] text-center m-0 mb-[var(--spacing-sm)]">Quick Start</h2>
          <p class="text-[var(--font-size-paragraph-m)] text-[var(--color-secondary)] text-center m-0 mb-[var(--spacing-lg)]">
            Get started in 5 minutes with this copy-paste workflow
          </p>
          <CodeBlock
            code={quickStart}
            lang="bash"
            title="Installation to First Feature"
          />
          <div class="flex justify-center mt-[var(--spacing-md)]">
            <Button href="/get-started" variant="secondary">
              Full Tutorial
            </Button>
          </div>
        </div>
      </div>
    </section>

    <!-- Command Reference -->
    <section class="py-[var(--spacing-section-xl)]">
      <div class="content-max">
        {commandCategories.map((category, categoryIndex) => (
          <div class:list={[
            'mb-[var(--spacing-xl)] pb-[var(--spacing-xl)] border-b-2 border-[var(--color-border)]',
            categoryIndex === commandCategories.length - 1 && '!border-b-0'
          ]}>
            <div class="mb-[var(--spacing-xl)]">
              <h2 class="text-[var(--font-size-display-m)] font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">{category.title}</h2>
              <p class="text-[var(--font-size-paragraph-m)] text-[var(--color-secondary)] m-0">{category.description}</p>
            </div>

            <div class="flex flex-col gap-[var(--spacing-xl)]">
              {category.commands.map((command) => (
                <div class="p-[var(--spacing-lg)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-xl md:p-[var(--spacing-md)]" id={command.name.replace('/', '').replace(':', '-')}>
                  <div class="mb-[var(--spacing-sm)]">
                    <h3 class="m-0">
                      <code class="text-xl font-bold text-[var(--color-accent)] bg-transparent p-0">{command.name}</code>
                    </h3>
                  </div>

                  <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0 mb-[var(--spacing-md)]">{command.description}</p>

                  <div class="py-[var(--spacing-sm)] px-[var(--spacing-md)] bg-[var(--color-background)] rounded-md mb-[var(--spacing-sm)]">
                    <div class="text-[0.8125rem] font-semibold text-[var(--color-primary)] uppercase tracking-wider mb-1">Usage:</div>
                    <code class="font-['Fira_Code',monospace] text-sm text-[var(--color-primary)] block">{command.usage}</code>
                  </div>

                  {command.flags && command.flags.length > 0 && (
                    <div class="pt-[var(--spacing-sm)]">
                      <div class="text-[0.8125rem] font-semibold text-[var(--color-primary)] uppercase tracking-wider mb-2">Flags:</div>
                      <ul class="list-none p-0 m-0 flex flex-col gap-2">
                        {command.flags.map((flag) => (
                          <li class="text-sm text-[var(--color-secondary)]">
                            <code class="text-[0.8125rem] text-[var(--color-accent)] bg-[rgba(217,119,87,0.1)] px-1.5 py-0.5 rounded">{flag.flag}</code> - {flag.description}
                          </li>
                        ))}
                      </ul>
                    </div>
                  )}
                </div>
              ))}
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- Configuration Reference -->
    <section class="bg-[var(--color-surface)] py-[var(--spacing-section-lg)]">
      <div class="content-max">
        <div class="text-center max-w-[48rem] mx-auto mb-[var(--spacing-xl)]">
          <h2 class="text-[var(--font-size-display-m)] font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">Configuration Files</h2>
          <p class="text-[var(--font-size-paragraph-m)] text-[var(--color-secondary)] leading-relaxed m-0">
            Optional files to customize SpecSwarm behavior for your project
          </p>
        </div>

        <div class="grid grid-cols-[repeat(auto-fit,minmax(min(100%,20rem),1fr))] gap-[var(--spacing-lg)] md:grid-cols-1">
          <div class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl">
            <h3 class="font-['Fira_Code',monospace] text-base font-bold text-[var(--color-accent)] m-0 mb-[var(--spacing-sm)]">.specswarm/tech-stack.md</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0 mb-[var(--spacing-sm)]">
              Define approved technologies to prevent 95% of drift. List core technologies, approved libraries, and prohibited patterns.
            </p>
            <div class="p-[var(--spacing-sm)] bg-[rgba(217,119,87,0.1)] rounded-md text-sm text-[var(--color-secondary)] leading-relaxed">
              <strong class="text-[var(--color-primary)]">Example:</strong> Enforce React 19 functional components, block Redux in favor of React Router loaders
            </div>
          </div>

          <div class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl">
            <h3 class="font-['Fira_Code',monospace] text-base font-bold text-[var(--color-accent)] m-0 mb-[var(--spacing-sm)]">.specswarm/quality-standards.md</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0 mb-[var(--spacing-sm)]">
              Set quality thresholds and performance budgets. Defines minimum test coverage, quality scores, and bundle size limits.
            </p>
            <div class="p-[var(--spacing-sm)] bg-[rgba(217,119,87,0.1)] rounded-md text-sm text-[var(--color-secondary)] leading-relaxed">
              <strong class="text-[var(--color-primary)]">Example:</strong> Require 85% test coverage, 500KB max bundle size, block merges below 80 quality score
            </div>
          </div>

          <div class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl">
            <h3 class="font-['Fira_Code',monospace] text-base font-bold text-[var(--color-accent)] m-0 mb-[var(--spacing-sm)]">.specswarm/constitution.md</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0 mb-[var(--spacing-sm)]">
              Establish project governance and coding principles. Defines architectural patterns, code style rules, and decision-making processes.
            </p>
            <div class="p-[var(--spacing-sm)] bg-[rgba(217,119,87,0.1)] rounded-md text-sm text-[var(--color-secondary)] leading-relaxed">
              <strong class="text-[var(--color-primary)]">Example:</strong> Functional programming preferred, composition over inheritance, explicit over implicit
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Best Practices -->
    <section class="py-[var(--spacing-section-lg)]">
      <div class="content-max">
        <div class="text-center max-w-[48rem] mx-auto mb-[var(--spacing-xl)]">
          <h2 class="text-[var(--font-size-display-m)] font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">Best Practices</h2>
          <p class="text-[var(--font-size-paragraph-m)] text-[var(--color-secondary)] leading-relaxed m-0">
            Proven patterns for effective SpecSwarm usage
          </p>
        </div>

        <div class="grid grid-cols-[repeat(auto-fit,minmax(min(100%,18rem),1fr))] gap-[var(--spacing-lg)] md:grid-cols-1">
          <div class="p-[var(--spacing-lg)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-xl">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">1. Define Tech Stack First</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Run <code class="text-sm text-[var(--color-accent)] bg-[rgba(217,119,87,0.1)] px-1.5 py-0.5 rounded">/specswarm:init</code> before building features. Tech stack enforcement prevents 95% of drift across all features.
            </p>
          </div>

          <div class="p-[var(--spacing-lg)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-xl">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">2. Use Simplified Workflow</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Start with <code class="text-sm text-[var(--color-accent)] bg-[rgba(217,119,87,0.1)] px-1.5 py-0.5 rounded">/specswarm:build</code> for 90% of features. Switch to granular only for complex architectural changes.
            </p>
          </div>

          <div class="p-[var(--spacing-lg)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-xl">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">3. Always Test Manually</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Even with <code class="text-sm text-[var(--color-accent)] bg-[rgba(217,119,87,0.1)] px-1.5 py-0.5 rounded">--validate</code> flag, manually test features before shipping. AI catches bugs, but human validation is critical.
            </p>
          </div>

          <div class="p-[var(--spacing-lg)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-xl">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">4. Check Quality Before Merge</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Run <code class="text-sm text-[var(--color-accent)] bg-[rgba(217,119,87,0.1)] px-1.5 py-0.5 rounded">/specswarm:analyze-quality</code> to catch issues early. Fix before <code class="text-sm text-[var(--color-accent)] bg-[rgba(217,119,87,0.1)] px-1.5 py-0.5 rounded">/specswarm:ship</code> blocks the merge.
            </p>
          </div>

          <div class="p-[var(--spacing-lg)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-xl">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">5. Use Correct Parent Branch</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Always checkout parent branch before starting features. SpecSwarm merges back to the branch you started from.
            </p>
          </div>

          <div class="p-[var(--spacing-lg)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-xl">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">6. Review Planning Artifacts</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Check spec.md, plan.md, and tasks.md before implementation. Catch issues during planning, not during code review.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- External Resources -->
    <section class="bg-[var(--color-surface)] py-[var(--spacing-section-lg)]">
      <div class="content-max">
        <div class="text-center max-w-[48rem] mx-auto mb-[var(--spacing-xl)]">
          <h2 class="text-[var(--font-size-display-m)] font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-sm)]">Additional Resources</h2>
        </div>

        <div class="grid grid-cols-[repeat(auto-fit,minmax(min(100%,18rem),1fr))] gap-[var(--spacing-lg)] md:grid-cols-1">
          <a href="https://github.com/MartyBonacci/specswarm" target="_blank" rel="noopener noreferrer" class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl no-underline transition-all duration-[var(--duration-fast)] ease-out hover:border-[var(--color-accent)] hover:-translate-y-0.5 hover:shadow-[0_4px_16px_rgba(217,119,87,0.1)] motion-reduce:hover:transform-none">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-xs)]">GitHub Repository</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Source code, issue tracker, and community discussions
            </p>
          </a>

          <a href="https://github.com/MartyBonacci/specswarm/blob/main/docs/WORKFLOW.md" target="_blank" rel="noopener noreferrer" class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl no-underline transition-all duration-[var(--duration-fast)] ease-out hover:border-[var(--color-accent)] hover:-translate-y-0.5 hover:shadow-[0_4px_16px_rgba(217,119,87,0.1)] motion-reduce:hover:transform-none">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-xs)]">Complete Workflow Guide</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Step-by-step guide with real-world examples and troubleshooting
            </p>
          </a>

          <a href="https://github.com/MartyBonacci/specswarm/blob/main/docs/CHEATSHEET.md" target="_blank" rel="noopener noreferrer" class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl no-underline transition-all duration-[var(--duration-fast)] ease-out hover:border-[var(--color-accent)] hover:-translate-y-0.5 hover:shadow-[0_4px_16px_rgba(217,119,87,0.1)] motion-reduce:hover:transform-none">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-xs)]">Quick Reference Cheat Sheet</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Visual command reference and configuration templates
            </p>
          </a>

          <a href="https://github.com/MartyBonacci/specswarm/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl no-underline transition-all duration-[var(--duration-fast)] ease-out hover:border-[var(--color-accent)] hover:-translate-y-0.5 hover:shadow-[0_4px_16px_rgba(217,119,87,0.1)] motion-reduce:hover:transform-none">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-xs)]">Changelog</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Version history, new features, and Feature 015 validation details
            </p>
          </a>

          <a href="https://docs.claude.com/en/docs/claude-code" target="_blank" rel="noopener noreferrer" class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl no-underline transition-all duration-[var(--duration-fast)] ease-out hover:border-[var(--color-accent)] hover:-translate-y-0.5 hover:shadow-[0_4px_16px_rgba(217,119,87,0.1)] motion-reduce:hover:transform-none">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-xs)]">Claude Code Documentation</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Official Claude Code docs for getting started and advanced usage
            </p>
          </a>

          <a href="https://github.com/MartyBonacci/specswarm/issues" target="_blank" rel="noopener noreferrer" class="p-[var(--spacing-lg)] bg-[var(--color-background)] border border-[var(--color-border)] rounded-xl no-underline transition-all duration-[var(--duration-fast)] ease-out hover:border-[var(--color-accent)] hover:-translate-y-0.5 hover:shadow-[0_4px_16px_rgba(217,119,87,0.1)] motion-reduce:hover:transform-none">
            <h3 class="text-lg font-bold text-[var(--color-primary)] m-0 mb-[var(--spacing-xs)]">Report Issues</h3>
            <p class="text-[0.9375rem] text-[var(--color-secondary)] leading-relaxed m-0">
              Bug reports, feature requests, and support questions
            </p>
          </a>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="bg-[var(--color-background)] py-[var(--spacing-section-xl)]">
      <div class="content-max">
        <div class="max-w-[48rem] mx-auto text-center flex flex-col items-center gap-[var(--spacing-lg)]">
          <h2 class="text-[var(--font-size-display-m)] font-bold text-[var(--color-primary)] m-0">Ready to Get Started?</h2>
          <p class="text-[var(--font-size-paragraph-m)] text-[var(--color-secondary)] leading-relaxed m-0">
            Install SpecSwarm and build your first feature with tech stack enforcement and quality gates.
          </p>
          <div class="flex gap-[var(--spacing-md)] flex-wrap justify-center md:flex-col md:w-full [&>*]:md:w-full">
            <Button href="/get-started" variant="primary" size="lg">
              Get Started Now
            </Button>
            <Button href="/use-cases" variant="secondary" size="lg">
              View Use Cases
            </Button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</BaseLayout>
