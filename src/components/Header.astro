---
import AnimatedBrand from './AnimatedBrand';
import MobileMenu from './MobileMenu';

const navLinks = [
  { href: '/', label: 'Home' },
  { href: '/features', label: 'Features' },
  { href: '/get-started', label: 'Get Started' },
  { href: '/docs', label: 'Docs' },
  { href: '/use-cases', label: 'Use Cases' },
];

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-[99999] bg-[var(--color-background)] border-b border-[var(--color-border)]">
  <nav class="w-full" aria-label="Main navigation">
    <div class="mx-auto px-[var(--spacing-site-margin)] h-[var(--nav-height)] flex items-center gap-[var(--spacing-lg)] md:h-[var(--nav-height-mobile)] md:gap-[var(--spacing-sm)]">
      <!-- Logo -->
      <a href="/" class="text-xl font-bold text-[var(--color-primary)] no-underline transition-opacity duration-[var(--duration-fast)] ease-out hover:opacity-70" aria-label="SpecSwarm Home">
        <span class="inline-block">
          <AnimatedBrand client:load />
        </span>
      </a>

      <!-- Desktop Navigation Links -->
      <ul class="flex items-center gap-[var(--spacing-md)] list-none m-0 p-0 ml-auto md:hidden" role="list">
        {navLinks.map((link) => (
          <li>
            <a
              href={link.href}
              class:list={[
                'relative py-2 text-[0.9375rem] font-medium text-[var(--color-secondary)] no-underline transition-colors duration-[var(--duration-fast)] ease-out hover:text-[var(--color-primary)]',
                currentPath === link.href && 'text-[var(--color-primary)] after:content-[""] after:absolute after:bottom-0 after:left-0 after:right-0 after:h-[2px] after:bg-[var(--color-accent)]'
              ]}
              aria-current={currentPath === link.href ? 'page' : undefined}
            >
              {link.label}
            </a>
          </li>
        ))}
      </ul>

      <!-- Desktop GitHub Link -->
      <a
        href="https://github.com/MartyBonacci/specswarm"
        class="flex items-center gap-2 py-2 px-4 border border-[var(--color-border)] rounded-lg text-[var(--color-primary)] no-underline text-[0.9375rem] font-medium transition-all duration-[var(--duration-fast)] ease-out hover:border-[var(--color-accent)] hover:bg-[var(--color-surface)] ml-[var(--spacing-sm)] md:hidden"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="View on GitHub"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
        </svg>
        <span>GitHub</span>
      </a>

      <!-- Mobile Menu Toggle -->
      <button
        class="mobile-menu-toggle hidden bg-transparent border-0 p-2 cursor-pointer ml-auto z-[51] md:block"
        aria-label="Toggle menu"
        aria-expanded="false"
        id="mobile-menu-toggle"
      >
        <span class="hamburger"></span>
      </button>
    </div>

    <!-- Mobile Menu -->
    <div class="!hidden md:hidden md:fixed md:top-[var(--nav-height-mobile)] md:left-0 md:right-0 md:bottom-0 md:bg-[var(--color-background)] md:z-[9999] md:overflow-y-auto md:p-[var(--spacing-lg)]" id="mobile-menu">
      <ul class="list-none p-0 m-0" role="list">
        {navLinks.map((link) => (
          <li>
            <a
              href={link.href}
              class:list={[
                'block py-[var(--spacing-md)] text-[var(--color-primary)] text-lg font-medium no-underline border-b border-[var(--color-border)] transition-colors duration-[var(--duration-fast)] ease-out hover:text-[var(--color-accent)]',
                currentPath === link.href && 'text-[var(--color-accent)] font-semibold'
              ]}
            >
              {link.label}
            </a>
          </li>
        ))}
        <li>
          <a
            href="https://github.com/MartyBonacci/specswarm"
            class="block py-[var(--spacing-md)] text-[var(--color-primary)] text-lg font-medium no-underline border-b border-[var(--color-border)] transition-colors duration-[var(--duration-fast)] ease-out hover:text-[var(--color-accent)]"
            target="_blank"
            rel="noopener noreferrer"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              aria-hidden="true"
              class="inline-block align-middle mr-2"
            >
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
            </svg>
            GitHub
          </a>
        </li>
      </ul>
    </div>
  </nav>
</header>

<MobileMenu client:load />

<style>
  /* Hamburger Icon Animation (preserve complex pseudo-element animations) */
  .hamburger {
    display: block;
    width: 24px;
    height: 2px;
    background-color: var(--color-primary);
    position: relative;
    transition: background-color 0.3s ease;
  }

  .hamburger::before,
  .hamburger::after {
    content: '';
    position: absolute;
    width: 24px;
    height: 2px;
    background-color: var(--color-primary);
    transition: transform 0.3s ease;
  }

  .hamburger::before {
    top: -7px;
  }

  .hamburger::after {
    bottom: -7px;
  }

  /* Animated hamburger when menu is open */
  .mobile-menu-toggle[aria-expanded="true"] .hamburger {
    background-color: transparent;
  }

  .mobile-menu-toggle[aria-expanded="true"] .hamburger::before {
    transform: rotate(45deg) translate(5px, 5px);
  }

  .mobile-menu-toggle[aria-expanded="true"] .hamburger::after {
    transform: rotate(-45deg) translate(5px, -5px);
  }

  /* Mobile menu visibility */
  @media (max-width: 768px) {
    #mobile-menu.mobile-menu-open {
      display: block !important;
    }
  }
</style>
