---
import AnimatedBrand from './AnimatedBrand';
import MobileMenu from './MobileMenu';

const navLinks = [
    {href: '/', label: 'Home'},
    {href: '/quick-start', label: 'Quick Start'},
    {href: '/features', label: 'Features'},
    {href: 'https://github.com/MartyBonacci/specswarm', label: 'Docs', external: true},
];

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-[99999] bg-[var(--color-background)] border-b border-[var(--color-border)]">
    <nav class="w-full" aria-label="Main navigation">
        <div class="mx-auto px-[var(--spacing-site-margin)] h-[var(--nav-height)] flex items-center gap-[var(--spacing-lg)] md:h-[var(--nav-height-mobile)] md:gap-[var(--spacing-sm)]">
            <!-- Logo -->
            <a href="/"
               class="text-xl font-bold text-[var(--color-primary)] no-underline transition-opacity duration-[var(--duration-fast)] ease-out hover:opacity-70"
               aria-label="SpecSwarm Home">
        <span class="inline-block">
          <AnimatedBrand client:load/>
        </span>
            </a>

            <!-- Desktop Navigation Links -->
            <ul class="hidden md:flex items-center gap-[var(--spacing-md)] list-none m-0 p-0 ml-auto" role="list">
                {navLinks.map((link) => (
                        <li>
                            <a
                                    href={link.href}
                                    class:list={[
                                        'relative py-2 text-[0.9375rem] font-medium text-[var(--color-primary)] no-underline transition-colors duration-[var(--duration-fast)] ease-out hover:text-[var(--color-accent)]',
                                        currentPath === link.href && 'text-[var(--color-primary)] after:content-[""] after:absolute after:bottom-0 after:left-0 after:right-0 after:h-[2px] after:bg-[var(--color-accent)]'
                                    ]}
                                    target={link.external ? '_blank' : undefined}
                                    rel={link.external ? 'noopener noreferrer' : undefined}
                                    aria-current={currentPath === link.href ? 'page' : undefined}
                            >
                                {link.label}
                            </a>
                        </li>
                ))}
            </ul>

            <!-- Mobile Menu Toggle -->
            <button
                    class="mobile-menu-toggle md:hidden bg-transparent border-0 p-2 cursor-pointer ml-auto z-[51]"
                    aria-label="Toggle menu"
                    aria-expanded="false"
                    id="mobile-menu-toggle"
            >
                <span class="hamburger"></span>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div class="hidden fixed top-[var(--nav-height-mobile)] left-0 right-0 bottom-0 bg-[var(--color-background)] z-[9999] overflow-y-auto p-[var(--spacing-lg)]"
             id="mobile-menu">
            <ul class="list-none p-0 m-0" role="list">
                {navLinks.map((link) => (
                        <li>
                            <a
                                    href={link.href}
                                    class:list={[
                                        'block py-[var(--spacing-md)] text-[var(--color-primary)] text-lg font-medium no-underline border-b border-[var(--color-border)] transition-colors duration-[var(--duration-fast)] ease-out hover:text-[var(--color-accent)]',
                                        currentPath === link.href && 'text-[var(--color-accent)] font-semibold'
                                    ]}
                                    target={link.external ? '_blank' : undefined}
                                    rel={link.external ? 'noopener noreferrer' : undefined}
                            >
                                {link.label}
                            </a>
                        </li>
                ))}
            </ul>
        </div>
    </nav>
</header>

<MobileMenu client:load/>

<style>
    /* Hamburger Icon Animation (preserve complex pseudo-element animations) */
    .hamburger {
        display: block;
        width: 24px;
        height: 2px;
        background-color: var(--color-primary);
        position: relative;
        transition: background-color 0.3s ease;
    }

    .hamburger::before,
    .hamburger::after {
        content: '';
        position: absolute;
        width: 24px;
        height: 2px;
        background-color: var(--color-primary);
        transition: transform 0.3s ease;
    }

    .hamburger::before {
        top: -7px;
    }

    .hamburger::after {
        bottom: -7px;
    }

    /* Animated hamburger when menu is open */
    .mobile-menu-toggle[aria-expanded="true"] .hamburger {
        background-color: transparent;
    }

    .mobile-menu-toggle[aria-expanded="true"] .hamburger::before {
        transform: rotate(45deg) translate(5px, 5px);
    }

    .mobile-menu-toggle[aria-expanded="true"] .hamburger::after {
        transform: rotate(-45deg) translate(5px, -5px);
    }

    /* Mobile menu visibility */
    #mobile-menu.mobile-menu-open {
        display: block;
    }
</style>
